(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63939,       1562]
NotebookOptionsPosition[     60302,       1439]
NotebookOutlinePosition[     61067,       1464]
CellTagsIndexPosition[     60901,       1458]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["SC/Coordinate generation", "Section",
 CellChangeTimes->{{3.623704137127449*^9, 3.62370413945601*^9}, {
  3.656793327542338*^9, 3.6567933350937862`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pos", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "33960"}]}], "}"}]}], 
  RowBox[{"(*", "km", "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dircen", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.619979286674713*^9, 3.619979316646006*^9}, {
  3.619986529480291*^9, 3.6199865340207787`*^9}, {3.619986715822234*^9, 
  3.619986717423242*^9}, {3.619986841962863*^9, 3.6199868671050167`*^9}, {
  3.619994289660961*^9, 3.6199942920418386`*^9}, {3.6199943751785727`*^9, 
  3.619994397775832*^9}, {3.619997381654339*^9, 3.619997384703952*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"viewdir", "[", 
   RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"RotationMatrix", "[", 
    RowBox[{
     RowBox[{"-", "\[Theta]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ".", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ".", 
   "dircen"}]}]], "Input",
 CellChangeTimes->{{3.619979337479516*^9, 3.619979344571025*^9}, {
   3.6199826824207973`*^9, 3.619982771770385*^9}, {3.6199828433014727`*^9, 
   3.6199828497523108`*^9}, {3.61998339392844*^9, 3.619983405882367*^9}, {
   3.619999205438648*^9, 3.619999209414474*^9}, {3.6237818450760727`*^9, 
   3.623781845649145*^9}, 3.623782109287033*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.619983406682384*^9, 3.6199836235267076`*^9, 3.619986537425667*^9, 
   3.619986718759379*^9, 3.619986868681817*^9, 3.619994296546739*^9, {
   3.619994382929512*^9, 3.6199943993205013`*^9}, 3.619997387560484*^9, 
   3.619999765186942*^9, 3.61999995618622*^9, 3.620000178808466*^9, 
   3.620000382726982*^9, 3.6200004629656067`*^9, 3.620000712991396*^9, 
   3.620001051889105*^9, 3.6200015232261877`*^9, 3.6200015532341843`*^9, 
   3.620001817217887*^9, 3.620002032807563*^9, 3.620002303382262*^9, 
   3.621876654496512*^9, 3.6237023686406612`*^9, 3.623781696822762*^9, 
   3.6237817333840837`*^9, {3.6237818394009743`*^9, 3.62378184611528*^9}, 
   3.623782110005171*^9, 3.652646763685404*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"viewdir", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"Yellow", ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.62378198693731*^9, 3.6237821730053797`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Theta]$$ = 0, $CellContext`\[Phi]$$ = 0, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Theta]$$], 0}, Rational[-1, 2] Pi, Rational[1, 2] 
      Pi}, {{
       Hold[$CellContext`\[Phi]$$], 0}, Rational[-1, 2] Pi, Rational[1, 2] 
      Pi}}, Typeset`size$$ = {360., {152., 158.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Theta]$5610$$ = 0, $CellContext`\[Phi]$5611$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Theta]$$ = 0, $CellContext`\[Phi]$$ = 0},
       "ControllerVariables" :> {
        Hold[$CellContext`\[Theta]$$, $CellContext`\[Theta]$5610$$, 0], 
        Hold[$CellContext`\[Phi]$$, $CellContext`\[Phi]$5611$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics3D[{
         Arrow[{{0, 0, 0}, 
           $CellContext`viewdir[$CellContext`\[Theta]$$, \
$CellContext`\[Phi]$$]}], {Yellow, 
          Arrow[{{0, 0, 0}, {1, 0, 0}}]}}, 
        PlotRange -> {{-1, 1}, {-1, 1}, {0, 1}}], 
      "Specifications" :> {{{$CellContext`\[Theta]$$, 0}, Rational[-1, 2] Pi, 
         Rational[1, 2] Pi}, {{$CellContext`\[Phi]$$, 0}, Rational[-1, 2] Pi, 
         Rational[1, 2] Pi}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{407., {208., 215.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6237820145621443`*^9, {3.623782051249958*^9, 3.623782098696053*^9}, 
   3.62378213019982*^9, 3.623782174919325*^9, 3.6526467646998177`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.619986547525591*^9, 3.619986596124515*^9}, {
  3.623702387428039*^9, 3.623702388846789*^9}, {3.6237817050014877`*^9, 
  3.623781714800405*^9}}],

Cell[BoxData["\<\"/home/mike/Documents/Mars/3D_Thomas_model\"\>"], "Output",
 CellChangeTimes->{{3.619986559861327*^9, 3.619986596662713*^9}, 
   3.6199867231660843`*^9, 3.619986806162575*^9, 3.619986873174107*^9, 
   3.6199874351201153`*^9, 3.619987607932111*^9, 3.619987686037187*^9, 
   3.619987879588778*^9, 3.619987926534362*^9, 3.619994110571869*^9, 
   3.619994156145748*^9, 3.61999426648995*^9, 3.619994301422201*^9, {
   3.619994357679138*^9, 3.6199944023579073`*^9}, 3.619997405592287*^9, 
   3.619998206883792*^9, 3.619998307646912*^9, {3.619998444472437*^9, 
   3.619998519036978*^9}, 3.619998978928193*^9, 3.619999051522306*^9, 
   3.619999776117243*^9, 3.6199999599200077`*^9, 3.6200001877021112`*^9, 
   3.620000384419262*^9, 3.6200004646045113`*^9, 3.620000714584242*^9, 
   3.620001054397748*^9, {3.620001524896492*^9, 3.620001553920371*^9}, 
   3.6200018188871803`*^9, 3.620002034525874*^9, 3.6200023051178913`*^9, 
   3.621876655696558*^9, {3.6237817152607517`*^9, 3.623781734131083*^9}, 
   3.623781848069434*^9, 3.6526467664864883`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]range", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "30"}], "\[Degree]"}], ",", 
     RowBox[{"30", "\[Degree]"}], ",", 
     RowBox[{"1.", "\[Degree]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]range", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "30"}], "\[Degree]"}], ",", 
     RowBox[{"30", "\[Degree]"}], ",", 
     RowBox[{"1.", "\[Degree]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6199991641464853`*^9, 3.619999186633198*^9}, {
   3.6199992187584467`*^9, 3.6199992495083523`*^9}, {3.619999493619677*^9, 
   3.619999496056333*^9}, {3.619999627626248*^9, 3.619999632823722*^9}, {
   3.61999967413899*^9, 3.619999675285788*^9}, {3.619999728312376*^9, 
   3.619999729805563*^9}, {3.619999891308422*^9, 3.619999893689045*^9}, {
   3.6199999334001617`*^9, 3.619999939574855*^9}, {3.619999988752043*^9, 
   3.620000011844149*^9}, {3.620000213248201*^9, 3.620000216290284*^9}, {
   3.620000320451847*^9, 3.6200003372859287`*^9}, {3.620000657771574*^9, 
   3.620000658680821*^9}, {3.620000784956025*^9, 3.6200008081151*^9}, {
   3.620001056435318*^9, 3.620001056491045*^9}, 3.6200011033594627`*^9, {
   3.620001175847883*^9, 3.620001176597136*^9}, {3.62000152725766*^9, 
   3.620001563481256*^9}, {3.6200017864147987`*^9, 3.620001789994206*^9}, {
   3.6200020368300037`*^9, 3.620002038997652*^9}, {3.620002280076091*^9, 
   3.6200022822840233`*^9}, {3.623702396289083*^9, 3.6237024173264427`*^9}, {
   3.6237042355674686`*^9, 3.623704308348569*^9}, {3.623704436162589*^9, 
   3.6237044373681793`*^9}, 3.623781866017716*^9, {3.6237821839926367`*^9, 
   3.623782184751045*^9}, {3.652646770389823*^9, 3.6526467729737263`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Length", "[", "\[Phi]range", "]"}], "*", 
  RowBox[{"Length", "[", "\[Theta]range", "]"}]}]], "Input",
 CellChangeTimes->{{3.619983474637292*^9, 3.6199835028752213`*^9}, {
   3.619983612684247*^9, 3.619983631839437*^9}, {3.61998734423412*^9, 
   3.619987443248355*^9}, {3.61998786440324*^9, 3.6199878758741703`*^9}, 
   3.6199943535036917`*^9, {3.619997400686469*^9, 3.6199974012674637`*^9}, 
   3.6199980194795437`*^9, 3.619998478460103*^9, 3.623704149068405*^9, {
   3.623704191362262*^9, 3.623704207482267*^9}}],

Cell[BoxData["3721"], "Output",
 CellChangeTimes->{{3.623704197810873*^9, 3.62370420853012*^9}, 
   3.623704286188685*^9, 3.623704438501853*^9, {3.623781850479467*^9, 
   3.623781867879663*^9}, 3.6237819166896553`*^9, 3.623782186868802*^9, 
   3.652646775558798*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"coordstable", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.0", ",", "0.1"}], "}"}], ",", "pos", ",", 
         RowBox[{"viewdir", "[", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Norm", "[", "#", "]"}], ",", 
             RowBox[{
              RowBox[{
               FractionBox["180", "\[Pi]"], 
               RowBox[{"ArcTan", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "2"]}]]}], "]"}]}], "/.", 
              
              RowBox[{"Indeterminate", "\[Rule]", "0"}]}]}], "}"}], "&"}], 
          "@", 
          RowBox[{"(", 
           RowBox[{"pos", "-", 
            RowBox[{
             RowBox[{"viewdir", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"viewdir", "[", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ".", "pos"}], 
              ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", "10", ",", "0"}], "}"}]}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "\[Phi]range"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", 
        RowBox[{"{", "0", "}"}]}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6237041529746447`*^9, 3.623704184425548*^9}, {
  3.62370432394769*^9, 3.623704385600881*^9}, {3.6237045036338863`*^9, 
  3.623704511102234*^9}, {3.623705344630973*^9, 3.6237053593222218`*^9}, {
  3.6237053969254208`*^9, 3.6237054022197523`*^9}, {3.6237818998384323`*^9, 
  3.6237819012754707`*^9}, {3.623781938697229*^9, 3.623781945257124*^9}, {
  3.6237821920857162`*^9, 3.623782210685966*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ArcTan", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(ArcTan[\\(\\(0.`, \
0.`\\)\\)]\\)\[NoBreak] encountered. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/indet\\\", \
ButtonNote -> \\\"ArcTan::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.623782211147397*^9, 3.6526467763695593`*^9, 3.6526550703391542`*^9, {
   3.652655147252303*^9, 3.6526551674204884`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{"coordstable", ",", 
     RowBox[{"x_", "/;", 
      RowBox[{"Not", "[", 
       RowBox[{"NumericQ", "[", "x", "]"}], "]"}]}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}], ",", 
   RowBox[{"x_", "/;", 
    RowBox[{"MemberQ", "[", 
     RowBox[{"x", ",", "0"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.623704334452218*^9, 3.623704349490979*^9}, {
  3.623704390849647*^9, 3.623704415434211*^9}, {3.623704446539157*^9, 
  3.6237044640347013`*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.62370440393126*^9, 3.623704472080051*^9}, 
   3.623704546309848*^9, 3.623705362905271*^9, 3.623705404338979*^9, {
   3.6237818768502493`*^9, 3.6237819465738163`*^9}, {3.623782203150181*^9, 
   3.623782212533319*^9}, 3.652646777294835*^9, 3.652655071058567*^9, {
   3.652655148204444*^9, 3.652655168128936*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coordstable", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "#", "]"}], "]"}], "-", "1"}], "}"}], ",", 
        RowBox[{"#", "\[Transpose]"}]}], "]"}], "\[Transpose]"}], "&"}], "@", 
    
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DeleteCases", "[", 
       RowBox[{"coordstable", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"6", ";;", "7"}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0."}], "}"}]}]}]}], "]"}], "//", "N"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coordsstring", "=", 
   RowBox[{
    RowBox[{"Riffle", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "\"\<  \>\"", "}"}], ",", 
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{"ToString", "/@", "#"}], ",", "\"\<  \>\""}], "]"}]}], 
          "]"}], "]"}], "&"}], "/@", 
       RowBox[{"(", "coordstable", ")"}]}], ",", "\"\<\\n\>\""}], "]"}], "//",
     "StringJoin"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coordfile", "=", 
   RowBox[{"\"\<   \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"Length", "[", "coordstable", "]"}], "]"}], "<>", 
    "\"\< 1.466 3.8976965e15 1.0460000e2 3376.242\\n\>\"", "<>", 
    "coordsstring"}]}], ";", 
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<fake_corona_obs_small.dat\>\"", ",", "coordfile", ",", 
    "\"\<Text\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6526467946541*^9, 3.6526467955498037`*^9}, {
  3.6526551077436247`*^9, 3.652655164805376*^9}}],

Cell[CellGroupData[{

Cell[BoxData["coordfile"], "Input",
 CellChangeTimes->{{3.623782266777637*^9, 3.623782268500449*^9}}],

Cell[BoxData["\<\"   60 1.466 3.8976965e15 1.0460000e2 3376.242\\n  0  1.  \
0.1  0.  0.  -33960.  -0.5  0.  0.866025  16980.  150.  10.  10.  0.\\n  1  \
1.  0.1  0.  0.  -33960.  -0.48481  0.  0.87462  16464.1  151.  10.  10.  \
0.\\n  2  1.  0.1  0.  0.  -33960.  -0.469472  0.  0.882948  15943.3  152.  \
10.  10.  0.\\n  3  1.  0.1  0.  0.  -33960.  -0.45399  0.  0.891007  15417.5 \
 153.  10.  10.  0.\\n  4  1.  0.1  0.  0.  -33960.  -0.438371  0.  0.898794  \
14887.1  154.  10.  10.  0.\\n  5  1.  0.1  0.  0.  -33960.  -0.422618  0.  \
0.906308  14352.1  155.  10.  10.  0.\\n  6  1.  0.1  0.  0.  -33960.  \
-0.406737  0.  0.913545  13812.8  156.  10.  10.  0.\\n  7  1.  0.1  0.  0.  \
-33960.  -0.390731  0.  0.920505  13269.2  157.  10.  10.  0.\\n  8  1.  0.1  \
0.  0.  -33960.  -0.374607  0.  0.927184  12721.6  158.  10.  10.  0.\\n  9  \
1.  0.1  0.  0.  -33960.  -0.358368  0.  0.93358  12170.2  159.  10.  10.  0.\
\\n  10  1.  0.1  0.  0.  -33960.  -0.34202  0.  0.939693  11615.  160.  10.  \
10.  0.\\n  11  1.  0.1  0.  0.  -33960.  -0.325568  0.  0.945519  11056.3  \
161.  10.  10.  0.\\n  12  1.  0.1  0.  0.  -33960.  -0.309017  0.  0.951057  \
10494.2  162.  10.  10.  0.\\n  13  1.  0.1  0.  0.  -33960.  -0.292372  0.  \
0.956305  9928.94  163.  10.  10.  0.\\n  14  1.  0.1  0.  0.  -33960.  \
-0.275637  0.  0.961262  9360.64  164.  10.  10.  0.\\n  15  1.  0.1  0.  0.  \
-33960.  -0.258819  0.  0.965926  8789.49  165.  10.  10.  0.\\n  16  1.  0.1 \
 0.  0.  -33960.  -0.241922  0.  0.970296  8215.67  166.  10.  10.  0.\\n  17 \
 1.  0.1  0.  0.  -33960.  -0.224951  0.  0.97437  7639.34  167.  10.  10.  \
0.\\n  18  1.  0.1  0.  0.  -33960.  -0.207912  0.  0.978148  7060.68  168.  \
10.  10.  0.\\n  19  1.  0.1  0.  0.  -33960.  -0.190809  0.  0.981627  \
6479.87  169.  10.  10.  0.\\n  20  1.  0.1  0.  0.  -33960.  -0.173648  0.  \
0.984808  5897.09  170.  10.  10.  0.\\n  21  1.  0.1  0.  0.  -33960.  \
-0.156434  0.  0.987688  5312.51  171.  10.  10.  0.\\n  22  1.  0.1  0.  0.  \
-33960.  -0.139173  0.  0.990268  4726.32  172.  10.  10.  0.\\n  23  1.  0.1 \
 0.  0.  -33960.  -0.121869  0.  0.992546  4138.68  173.  10.  10.  0.\\n  24 \
 1.  0.1  0.  0.  -33960.  -0.104528  0.  0.994522  3549.79  174.  10.  10.  \
0.\\n  25  1.  0.1  0.  0.  -33960.  -0.0871557  0.  0.996195  2959.81  175.  \
10.  10.  0.\\n  26  1.  0.1  0.  0.  -33960.  -0.0697565  0.  0.997564  \
2368.93  176.  10.  10.  0.\\n  27  1.  0.1  0.  0.  -33960.  -0.052336  0.  \
0.99863  1777.33  177.  10.  10.  0.\\n  28  1.  0.1  0.  0.  -33960.  \
-0.0348995  0.  0.999391  1185.19  178.  10.  10.  0.\\n  29  1.  0.1  0.  0. \
 -33960.  -0.0174524  0.  0.999848  592.684  179.  10.  10.  0.\\n  30  1.  \
0.1  0.  0.  -33960.  0.0174524  0.  0.999848  592.684  1.  10.  10.  0.\\n  \
31  1.  0.1  0.  0.  -33960.  0.0348995  0.  0.999391  1185.19  2.  10.  10.  \
0.\\n  32  1.  0.1  0.  0.  -33960.  0.052336  0.  0.99863  1777.33  3.  10.  \
10.  0.\\n  33  1.  0.1  0.  0.  -33960.  0.0697565  0.  0.997564  2368.93  \
4.  10.  10.  0.\\n  34  1.  0.1  0.  0.  -33960.  0.0871557  0.  0.996195  \
2959.81  5.  10.  10.  0.\\n  35  1.  0.1  0.  0.  -33960.  0.104528  0.  \
0.994522  3549.79  6.  10.  10.  0.\\n  36  1.  0.1  0.  0.  -33960.  \
0.121869  0.  0.992546  4138.68  7.  10.  10.  0.\\n  37  1.  0.1  0.  0.  \
-33960.  0.139173  0.  0.990268  4726.32  8.  10.  10.  0.\\n  38  1.  0.1  \
0.  0.  -33960.  0.156434  0.  0.987688  5312.51  9.  10.  10.  0.\\n  39  1. \
 0.1  0.  0.  -33960.  0.173648  0.  0.984808  5897.09  10.  10.  10.  0.\\n  \
40  1.  0.1  0.  0.  -33960.  0.190809  0.  0.981627  6479.87  11.  10.  10.  \
0.\\n  41  1.  0.1  0.  0.  -33960.  0.207912  0.  0.978148  7060.68  12.  \
10.  10.  0.\\n  42  1.  0.1  0.  0.  -33960.  0.224951  0.  0.97437  7639.34 \
 13.  10.  10.  0.\\n  43  1.  0.1  0.  0.  -33960.  0.241922  0.  0.970296  \
8215.67  14.  10.  10.  0.\\n  44  1.  0.1  0.  0.  -33960.  0.258819  0.  \
0.965926  8789.49  15.  10.  10.  0.\\n  45  1.  0.1  0.  0.  -33960.  \
0.275637  0.  0.961262  9360.64  16.  10.  10.  0.\\n  46  1.  0.1  0.  0.  \
-33960.  0.292372  0.  0.956305  9928.94  17.  10.  10.  0.\\n  47  1.  0.1  \
0.  0.  -33960.  0.309017  0.  0.951057  10494.2  18.  10.  10.  0.\\n  48  \
1.  0.1  0.  0.  -33960.  0.325568  0.  0.945519  11056.3  19.  10.  10.  \
0.\\n  49  1.  0.1  0.  0.  -33960.  0.34202  0.  0.939693  11615.  20.  10.  \
10.  0.\\n  50  1.  0.1  0.  0.  -33960.  0.358368  0.  0.93358  12170.2  21. \
 10.  10.  0.\\n  51  1.  0.1  0.  0.  -33960.  0.374607  0.  0.927184  \
12721.6  22.  10.  10.  0.\\n  52  1.  0.1  0.  0.  -33960.  0.390731  0.  \
0.920505  13269.2  23.  10.  10.  0.\\n  53  1.  0.1  0.  0.  -33960.  \
0.406737  0.  0.913545  13812.8  24.  10.  10.  0.\\n  54  1.  0.1  0.  0.  \
-33960.  0.422618  0.  0.906308  14352.1  25.  10.  10.  0.\\n  55  1.  0.1  \
0.  0.  -33960.  0.438371  0.  0.898794  14887.1  26.  10.  10.  0.\\n  56  \
1.  0.1  0.  0.  -33960.  0.45399  0.  0.891007  15417.5  27.  10.  10.  \
0.\\n  57  1.  0.1  0.  0.  -33960.  0.469472  0.  0.882948  15943.3  28.  \
10.  10.  0.\\n  58  1.  0.1  0.  0.  -33960.  0.48481  0.  0.87462  16464.1  \
29.  10.  10.  0.\\n  59  1.  0.1  0.  0.  -33960.  0.5  0.  0.866025  16980. \
 30.  10.  10.  0.\"\>"], "Output",
 CellChangeTimes->{3.6237822689111013`*^9, 3.652646781495326*^9, 
  3.652647310440632*^9, 3.652655170399296*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["nH/T grid interpolation", "Section",
 CellChangeTimes->{{3.6567933394303713`*^9, 3.656793349102375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656793691281831*^9, 3.6567936965989103`*^9}}],

Cell[BoxData["\<\"/home/mike/Documents/Mars/3D_Thomas_model\"\>"], "Output",
 CellChangeTimes->{3.656793697098111*^9, 3.656796172042336*^9, 
  3.657298971223688*^9, 3.657305540722003*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nHgridpts", "=", 
  RowBox[{"Exp", "[", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"Log", "[", "10000", "]"}], ",", 
     RowBox[{"Log", "[", "1000000", "]"}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"Log", "[", "1000000", "]"}], "-", 
       RowBox[{"Log", "[", "10000", "]"}]}], 
      RowBox[{"100.", "-", "1"}]]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.656793389361755*^9, 3.656793467470319*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10000.00000000001`", ",", "10476.15752789666`", ",", "10974.987654930577`",
    ",", "11497.569953977378`", ",", "12045.035402587824`", ",", 
   "12618.56883066021`", ",", "13219.4114846603`", ",", "13848.863713938745`",
    ",", "14508.287784959415`", ",", "15199.110829529362`", ",", 
   "15922.827933410925`", ",", "16681.005372000593`", ",", 
   "17475.28400007685`", ",", "18307.382802953696`", ",", 
   "19179.102616724907`", ",", "20092.3300256505`", ",", "21049.0414451202`", 
   ",", "22051.307399030462`", ",", "23101.297000831608`", ",", 
   "24201.282647943837`", ",", "25353.644939701142`", ",", 
   "26560.877829466895`", ",", "27825.59402207124`", ",", 
   "29150.530628251767`", ",", "30538.555088334164`", ",", 
   "31992.671377973853`", ",", "33516.02650938845`", ",", 
   "35111.917342151355`", ",", "36783.79771828639`", ",", 
   "38535.28593710529`", ",", "40370.172585965556`", ",", 
   "42292.428743895005`", ",", "44306.214575838836`", ",", 
   "46415.888336127835`", ",", "48626.01580065351`", ",", 
   "50941.38014816378`", ",", "53366.9923120631`", ",", "55908.101825122256`",
    ",", "58570.2081805667`", ",", "61359.07273413178`", ",", 
   "64280.73117284328`", ",", "67341.50657750819`", ",", "70548.02310718643`",
    ",", "73907.22033525779`", ",", "77426.36826811274`", ",", 
   "81113.08307896878`", ",", "84975.34359086452`", ",", "89021.50854450381`",
    ",", "93260.33468832196`", ",", "97700.99572992254`", ",", 
   "102353.10218990265`", ",", "107226.72220103239`", ",", 
   "112332.40329780284`", ",", "117681.19524349998`", ",", 
   "123284.67394420657`", ",", "129154.96650148838`", ",", 
   "135304.77745798073`", ",", "141747.4162926806`", ",", 
   "148496.82622544662`", ",", "155567.61439304706`", ",", 
   "162975.08346206433`", ",", "170735.26474706904`", ",", 
   "178864.9529057435`", ",", "187381.74228603847`", ",", 
   "196304.06500402722`", ",", "205651.23083486533`", ",", 
   "215443.46900318863`", ",", "225701.97196339193`", ",", 
   "236448.9412645407`", ",", "247707.63559917113`", ",", 
   "259502.4211399737`", ",", "271858.82427329425`", ",", 
   "284803.58684357995`", ",", "298364.7240283338`", ",", 
   "312571.5849688236`", ",", "327454.9162877729`", ",", 
   "343046.92863149196`", ",", "359381.36638046295`", ",", 
   "376493.58067924716`", ",", "394420.6059437653`", ",", 
   "413201.24001153355`", ",", "432876.1281083058`", ",", 
   "453487.8508128583`", ",", "475081.0162102799`", ",", 
   "497702.35643321055`", ",", "521400.8287999681`", ",", 
   "546227.7217684339`", ",", "572236.7659350216`", ",", "599484.2503189411`",
    ",", "628029.1441834255`", ",", "657933.2246575684`", ",", 
   "689261.2104349703`", ",", "722080.9018385472`", ",", "756463.3275546286`",
    ",", "792482.8983539173`", ",", "830217.5681319747`", ",", 
   "869749.0026177822`", ",", "911162.7561154884`", ",", "954548.4566618333`",
    ",", "999999.9999999995`"}], "}"}]], "Output",
 CellChangeTimes->{{3.656793425064024*^9, 3.656793467838924*^9}, 
   3.6567961728491077`*^9, 3.657298971411948*^9, 3.657305540807373*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Tgridpts", "=", 
  RowBox[{"Range", "[", 
   RowBox[{"100", ",", "2000", ",", "10"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Tgridpts", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.656793468706151*^9, 3.656793484388668*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "100", ",", "110", ",", "120", ",", "130", ",", "140", ",", "150", ",", 
   "160", ",", "170", ",", "180", ",", "190", ",", "200", ",", "210", ",", 
   "220", ",", "230", ",", "240", ",", "250", ",", "260", ",", "270", ",", 
   "280", ",", "290", ",", "300", ",", "310", ",", "320", ",", "330", ",", 
   "340", ",", "350", ",", "360", ",", "370", ",", "380", ",", "390", ",", 
   "400", ",", "410", ",", "420", ",", "430", ",", "440", ",", "450", ",", 
   "460", ",", "470", ",", "480", ",", "490", ",", "500", ",", "510", ",", 
   "520", ",", "530", ",", "540", ",", "550", ",", "560", ",", "570", ",", 
   "580", ",", "590", ",", "600", ",", "610", ",", "620", ",", "630", ",", 
   "640", ",", "650", ",", "660", ",", "670", ",", "680", ",", "690", ",", 
   "700", ",", "710", ",", "720", ",", "730", ",", "740", ",", "750", ",", 
   "760", ",", "770", ",", "780", ",", "790", ",", "800", ",", "810", ",", 
   "820", ",", "830", ",", "840", ",", "850", ",", "860", ",", "870", ",", 
   "880", ",", "890", ",", "900", ",", "910", ",", "920", ",", "930", ",", 
   "940", ",", "950", ",", "960", ",", "970", ",", "980", ",", "990", ",", 
   "1000", ",", "1010", ",", "1020", ",", "1030", ",", "1040", ",", "1050", 
   ",", "1060", ",", "1070", ",", "1080", ",", "1090", ",", "1100", ",", 
   "1110", ",", "1120", ",", "1130", ",", "1140", ",", "1150", ",", "1160", 
   ",", "1170", ",", "1180", ",", "1190", ",", "1200", ",", "1210", ",", 
   "1220", ",", "1230", ",", "1240", ",", "1250", ",", "1260", ",", "1270", 
   ",", "1280", ",", "1290", ",", "1300", ",", "1310", ",", "1320", ",", 
   "1330", ",", "1340", ",", "1350", ",", "1360", ",", "1370", ",", "1380", 
   ",", "1390", ",", "1400", ",", "1410", ",", "1420", ",", "1430", ",", 
   "1440", ",", "1450", ",", "1460", ",", "1470", ",", "1480", ",", "1490", 
   ",", "1500", ",", "1510", ",", "1520", ",", "1530", ",", "1540", ",", 
   "1550", ",", "1560", ",", "1570", ",", "1580", ",", "1590", ",", "1600", 
   ",", "1610", ",", "1620", ",", "1630", ",", "1640", ",", "1650", ",", 
   "1660", ",", "1670", ",", "1680", ",", "1690", ",", "1700", ",", "1710", 
   ",", "1720", ",", "1730", ",", "1740", ",", "1750", ",", "1760", ",", 
   "1770", ",", "1780", ",", "1790", ",", "1800", ",", "1810", ",", "1820", 
   ",", "1830", ",", "1840", ",", "1850", ",", "1860", ",", "1870", ",", 
   "1880", ",", "1890", ",", "1900", ",", "1910", ",", "1920", ",", "1930", 
   ",", "1940", ",", "1950", ",", "1960", ",", "1970", ",", "1980", ",", 
   "1990", ",", "2000"}], "}"}]], "Output",
 CellChangeTimes->{{3.656793478758561*^9, 3.656793484698298*^9}, 
   3.6567961734722233`*^9, 3.657298971505286*^9, 3.657305540840561*^9}],

Cell[BoxData["191"], "Output",
 CellChangeTimes->{{3.656793478758561*^9, 3.656793484698298*^9}, 
   3.6567961734722233`*^9, 3.657298971505286*^9, 3.657305540841346*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"allnHTpairs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Outer", "[", 
      RowBox[{"List", ",", 
       RowBox[{"MovingAverage", "[", 
        RowBox[{"nHgridpts", ",", "2"}], "]"}], ",", 
       RowBox[{"MovingAverage", "[", 
        RowBox[{"Tgridpts", ",", "2"}], "]"}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.656793487664605*^9, 3.656793552854919*^9}, {
  3.656796412664768*^9, 3.656796413024622*^9}}],

Cell[CellGroupData[{

Cell[BoxData["allnHTpairs"], "Input",
 CellChangeTimes->{{3.6567935407425003`*^9, 3.656793546798801*^9}, {
  3.6567964143124533`*^9, 3.656796416944429*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"10238.078763948335`", ",", "105"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10238.078763948335`", ",", "115"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10238.078763948335`", ",", "125"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10238.078763948335`", ",", "135"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10238.078763948335`", ",", "145"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10238.078763948335`", ",", "155"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10238.078763948335`", ",", "165"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10238.078763948335`", ",", "175"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10238.078763948335`", ",", "185"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10238.078763948335`", ",", "195"}], "}"}], ",", 
           TemplateBox[{"18791"},
            "OutputSizeLimit`Skeleton",
            DisplayFunction->(FrameBox[
              RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}],
               Background -> GrayLevel[0.75], 
              BaseStyle -> {
               "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
              ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
              GrayLevel[0.75], RoundingRadius -> 7]& )], ",", 
           RowBox[{"{", 
            RowBox[{"977274.2283309165`", ",", "1915"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"977274.2283309165`", ",", "1925"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"977274.2283309165`", ",", "1935"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"977274.2283309165`", ",", "1945"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"977274.2283309165`", ",", "1955"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"977274.2283309165`", ",", "1965"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"977274.2283309165`", ",", "1975"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"977274.2283309165`", ",", "1985"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"977274.2283309165`", ",", "1995"}], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{79., {3., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{69., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 6, 30691849902293234990, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{78., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 6, 30691849902293234990, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{60., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 6, 30691849902293234990, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{108., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[6]]], "Output",
 CellChangeTimes->{3.656793555155931*^9, 3.6567961749498653`*^9, 
  3.6567964176059628`*^9, 3.657298971834901*^9, 3.657305541024774*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allnHTpairs", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.6567964182091837`*^9, 3.656796420947138*^9}}],

Cell[BoxData["18810"], "Output",
 CellChangeTimes->{3.656796421163418*^9, 3.657298971928894*^9, 
  3.6573055410551434`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nHTpairs", "=", 
  RowBox[{"Union", "[", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", 
           RowBox[{"Sequence", "@@", "#"}]}], "]"}], "&"}], "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"MovingAverage", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"nHgridpts", ",", 
              RowBox[{
               RowBox[{"10000", "<", "#", "<", "50000"}], "&"}]}], "]"}], ",", 
            RowBox[{"Select", "[", 
             RowBox[{"Tgridpts", ",", 
              RowBox[{
               RowBox[{"100", "<", "#", "<", "2000"}], "&"}]}], "]"}]}], 
           "}"}]}], ")"}]}], ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", 
           RowBox[{"Sequence", "@@", "#"}]}], "]"}], "&"}], "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"MovingAverage", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"nHgridpts", ",", 
              RowBox[{
               RowBox[{"10000", "<", "#", "<", "1000000"}], "&"}]}], "]"}], 
            ",", 
            RowBox[{"Select", "[", 
             RowBox[{"Tgridpts", ",", 
              RowBox[{
               RowBox[{"100", "<", "#", "<", "600"}], "&"}]}], "]"}]}], 
           "}"}]}], ")"}]}], ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.656796222661344*^9, 3.656796461848784*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"10725.572591413618`", ",", "115"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10725.572591413618`", ",", "125"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10725.572591413618`", ",", "135"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10725.572591413618`", ",", "145"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10725.572591413618`", ",", "155"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10725.572591413618`", ",", "165"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10725.572591413618`", ",", "175"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10725.572591413618`", ",", "185"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10725.572591413618`", ",", "195"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"10725.572591413618`", ",", "205"}], "}"}], ",", 
           TemplateBox[{"9257"},
            "OutputSizeLimit`Skeleton",
            DisplayFunction->(FrameBox[
              RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}],
               Background -> GrayLevel[0.75], 
              BaseStyle -> {
               "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
              ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
              GrayLevel[0.75], RoundingRadius -> 7]& )], ",", 
           RowBox[{"{", 
            RowBox[{"932855.6063886608`", ",", "505"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"932855.6063886608`", ",", "515"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"932855.6063886608`", ",", "525"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"932855.6063886608`", ",", "535"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"932855.6063886608`", ",", "545"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"932855.6063886608`", ",", "555"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"932855.6063886608`", ",", "565"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"932855.6063886608`", ",", "575"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"932855.6063886608`", ",", "585"}], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{79., {3., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{69., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 8, 30691849902293234990, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{78., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 8, 30691849902293234990, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{60., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 8, 30691849902293234990, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{108., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[8]]], "Output",
 CellChangeTimes->{{3.6567963002314377`*^9, 3.6567963055268717`*^9}, 
   3.6567963477673063`*^9, {3.656796380976655*^9, 3.656796462535406*^9}, 
   3.657298972094454*^9, 3.6573055411541443`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nHTpairs", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.6567964301688147`*^9, 3.656796432643326*^9}}],

Cell[BoxData["9276"], "Output",
 CellChangeTimes->{{3.656796432970852*^9, 3.6567964644228897`*^9}, 
   3.657298974620822*^9, 3.657305541189948*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allnHTpairs", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.657298978286786*^9, 3.65729898099445*^9}}],

Cell[BoxData["18810"], "Output",
 CellChangeTimes->{3.657298981392708*^9, 3.6573055412252817`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Complement"}]], "Input",
 CellChangeTimes->{{3.657298987426236*^9, 3.657298993519143*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\<\"\!\(\*RowBox[{\\\"Complement\\\", \\\"[\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"e\\\", \\\"TI\\\"], StyleBox[\\\"all\\\", \
\\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"e\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"e\\\", \
\\\"TI\\\"], StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\
\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"]\\\"}]\) gives the elements in \
\!\(\*SubscriptBox[StyleBox[\\\"e\\\", \\\"TI\\\"], StyleBox[\\\"all\\\", \
\\\"TI\\\"]]\) that are not in any of the \!\(\*SubscriptBox[StyleBox[\\\"e\\\
\", \\\"TI\\\"], StyleBox[\\\"i\\\", \\\"TI\\\"]]\). \"\>", "MSG"], 
  "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/Complement"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.657305541549652*^9},
 CellTags->"Info-46dd79e8-6f75-4ce6-934f-33236c1b2fcf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"simstrings", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\"\<./simulate_coronal_scan.x -n \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\< -T \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
      "\"\< fake_corona_obs_small.dat\>\""}], "&"}], "/@", "nHTpairs"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6567935812420177`*^9, 3.656793644071192*^9}, 
   3.656795116399662*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RandomSample"}]], "Input",
 CellChangeTimes->{{3.656793747980837*^9, 3.6567937499053926`*^9}, {
  3.6567964746172132`*^9, 3.656796475304534*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\<\"\!\(\*RowBox[{\\\"RandomSample\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"e\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"e\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}], \\\",\\\", StyleBox[\\\"n\\\", \\\"TI\\\"]}], \\\"]\\\"}]\) gives a \
pseudorandom sample of \!\(\*StyleBox[\\\"n\\\", \\\"TI\\\"]\) of the \
\!\(\*SubscriptBox[StyleBox[\\\"e\\\", \\\"TI\\\"], StyleBox[\\\"i\\\", \
\\\"TI\\\"]]\).\\n\!\(\*RowBox[{\\\"RandomSample\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"w\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"w\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}], \\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"e\
\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"e\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}]}], \\\",\\\", StyleBox[\\\"n\\\", \\\"TI\\\"]}], \\\"]\\\"}]\) gives a \
pseudorandom sample of \!\(\*StyleBox[\\\"n\\\", \\\"TI\\\"]\) of the \
\!\(\*SubscriptBox[StyleBox[\\\"e\\\", \\\"TI\\\"], StyleBox[\\\"i\\\", \
\\\"TI\\\"]]\) chosen using weights \!\(\*SubscriptBox[StyleBox[\\\"w\\\", \\\
\"TI\\\"], StyleBox[\\\"i\\\", \
\\\"TI\\\"]]\).\\n\!\(\*RowBox[{\\\"RandomSample\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"e\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"e\\\", \
\\\"TI\\\"], StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\
\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\"}], \\\"]\\\"}]\) gives a \
pseudorandom permutation of the \!\(\*SubscriptBox[StyleBox[\\\"e\\\", \\\"TI\
\\\"], StyleBox[\\\"i\\\", \\\"TI\\\"]]\).\"\>", "MSG"], 
  "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/RandomSample"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.657305541650062*^9},
 CellTags->"Info-ab1e7796-99dc-4e29-91b8-46eb5fc1d089"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"simfiletext", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"Riffle", "[", 
     RowBox[{
      RowBox[{"RandomSample", "[", "simstrings", "]"}], ",", "\"\<\\n\>\""}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.656793645768713*^9, 3.656793672295102*^9}, {
  3.656793763407002*^9, 3.656793771422862*^9}, {3.6567938129672613`*^9, 
  3.656793822086915*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<populate_parameter_space_commands\>\"", ",", "simfiletext", ",", 
   "\"\<Text\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.656793673669169*^9, 3.6567937077349653`*^9}}],

Cell[BoxData["\<\"populate_parameter_space_commands\"\>"], "Output",
 CellChangeTimes->{{3.6567937019440117`*^9, 3.656793708017664*^9}, 
   3.6567937729501953`*^9, 3.65679382400702*^9, 3.656795119593051*^9, 
   3.656796479315797*^9, 3.6573055417533207`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nHTpairs", "//", "Length"}]], "Input"],

Cell[BoxData["9276"], "Output",
 CellChangeTimes->{3.656797128634201*^9, 3.657305541897588*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"remainingnHTpairs", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{"allnHTpairs", ",", "nHTpairs"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"remainingnHTpairs", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.657298997526825*^9, 3.657299010321314*^9}, {
  3.6572990544366293`*^9, 3.6572990683781757`*^9}}],

Cell[BoxData["9534"], "Output",
 CellChangeTimes->{
  3.657299010734234*^9, {3.657299066231916*^9, 3.657299068764522*^9}, 
   3.657305541933917*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"remainingsimstrings", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\"\<sleep 2; cd /projects/nick/mike/3d_thomas_model/; \
./simulate_coronal_scan.x -n \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\< -T \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
      "\"\< fake_corona_obs_small.dat\>\""}], "&"}], "/@", 
    "remainingnHTpairs"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6567935812420177`*^9, 3.656793644071192*^9}, 
   3.656795116399662*^9, {3.6572990510767317`*^9, 3.6572990732960367`*^9}, {
   3.657305545498126*^9, 3.657305570625293*^9}, 3.657306040609963*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"remainingsimfiletext", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"Riffle", "[", 
     RowBox[{
      RowBox[{"RandomSample", "[", "remainingsimstrings", "]"}], ",", 
      "\"\<\\n\>\""}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.657299080845421*^9, 3.657299090526922*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<remaining_populate_parameter_space_commands\>\"", ",", 
   "remainingsimfiletext", ",", "\"\<Text\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.6572992829805737`*^9, 3.657299288122613*^9}}],

Cell[BoxData["\<\"remaining_populate_parameter_space_commands\"\>"], "Output",
 CellChangeTimes->{3.6572992959391003`*^9, 3.65730559187883*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1407, 1748},
WindowMargins->{{Automatic, -10}, {Automatic, -10}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info-46dd79e8-6f75-4ce6-934f-33236c1b2fcf"->{
  Cell[52944, 1255, 966, 18, 48, "Print",
   CellTags->"Info-46dd79e8-6f75-4ce6-934f-33236c1b2fcf"]},
 "Info-ab1e7796-99dc-4e29-91b8-46eb5fc1d089"->{
  Cell[54701, 1300, 2352, 38, 87, "Print",
   CellTags->"Info-ab1e7796-99dc-4e29-91b8-46eb5fc1d089"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info-46dd79e8-6f75-4ce6-934f-33236c1b2fcf", 60625, 1449},
 {"Info-ab1e7796-99dc-4e29-91b8-46eb5fc1d089", 60775, 1452}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 159, 2, 66, "Section"],
Cell[742, 26, 680, 15, 55, "Input"],
Cell[CellGroupData[{
Cell[1447, 45, 797, 19, 32, "Input"],
Cell[2247, 66, 1034, 20, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3318, 91, 1595, 49, 55, "Input"],
Cell[4916, 142, 2342, 45, 440, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7295, 192, 270, 5, 32, "Input"],
Cell[7568, 199, 1057, 14, 32, "Output"]
}, Open  ]],
Cell[8640, 216, 1775, 33, 55, "Input"],
Cell[CellGroupData[{
Cell[10440, 253, 549, 9, 32, "Input"],
Cell[10992, 264, 266, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11295, 273, 2382, 61, 134, "Input"],
Cell[13680, 336, 581, 12, 24, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14298, 353, 550, 14, 32, "Input"],
Cell[14851, 369, 378, 6, 32, "Output"]
}, Open  ]],
Cell[15244, 378, 1881, 55, 99, "Input"],
Cell[CellGroupData[{
Cell[17150, 437, 101, 1, 32, "Input"],
Cell[17254, 440, 5450, 70, 1353, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[22753, 516, 110, 1, 52, "Section"],
Cell[CellGroupData[{
Cell[22888, 521, 172, 3, 32, "Input"],
Cell[23063, 526, 187, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23287, 533, 458, 12, 57, "Input"],
Cell[23748, 547, 3117, 50, 171, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26902, 602, 259, 5, 55, "Input"],
Cell[27164, 609, 2719, 38, 187, "Output"],
Cell[29886, 649, 168, 2, 32, "Output"]
}, Open  ]],
Cell[30069, 654, 493, 13, 32, "Input"],
Cell[CellGroupData[{
Cell[30587, 671, 156, 2, 32, "Input"],
Cell[30746, 675, 9580, 239, 137, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40363, 919, 133, 2, 32, "Input"],
Cell[40499, 923, 123, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40659, 930, 1911, 53, 143, "Input"],
Cell[42573, 985, 9627, 240, 137, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52237, 1230, 130, 2, 32, "Input"],
Cell[52370, 1234, 147, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52554, 1241, 130, 2, 32, "Input"],
Cell[52687, 1245, 98, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52822, 1251, 119, 2, 32, "Input"],
Cell[52944, 1255, 966, 18, 48, "Print",
 CellTags->"Info-46dd79e8-6f75-4ce6-934f-33236c1b2fcf"]
}, Open  ]],
Cell[53925, 1276, 574, 15, 32, "Input"],
Cell[CellGroupData[{
Cell[54524, 1295, 174, 3, 32, "Input"],
Cell[54701, 1300, 2352, 38, 87, "Print",
 CellTags->"Info-ab1e7796-99dc-4e29-91b8-46eb5fc1d089"]
}, Open  ]],
Cell[57068, 1341, 410, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[57503, 1355, 228, 5, 32, "Input"],
Cell[57734, 1362, 257, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58028, 1370, 62, 1, 32, "Input"],
Cell[58093, 1373, 95, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58225, 1379, 359, 8, 55, "Input"],
Cell[58587, 1389, 148, 3, 32, "Output"]
}, Open  ]],
Cell[58750, 1395, 774, 18, 77, "Input"],
Cell[59527, 1415, 329, 8, 32, "Input"],
Cell[CellGroupData[{
Cell[59881, 1427, 247, 5, 32, "Input"],
Cell[60131, 1434, 143, 1, 32, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
